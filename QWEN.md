# Fish - 摸鱼阅读器

## 项目概述

Fish 是一个轻量级的桌面阅读应用程序，采用 PyQt6 构建。该项目的主要目的是提供一个简洁、高效的浮动窗口阅读器，让用户可以方便地阅读文本文件，并通过键盘快捷键进行导航。

### 核心功能
- **浮动窗口界面**: 创建一个半透明的浮动窗口，显示文本内容
- **键盘导航**: 支持使用方向键（上/下）或 W/S 键来逐行浏览文本内容
- **进度保存**: 自动保存阅读进度，下次打开时从上次位置继续阅读
- **书架管理**: 使用 JSON 文件管理系统保存用户打开的书籍和进度信息
- **跨会话记忆**: 阅读进度信息存储在用户 AppData 目录中，重启应用后信息不丢失

### 技术架构
- **编程语言**: Python 3.13+
- **GUI 框架**: PyQt6
- **依赖管理**: 采用 uv 包管理器
- **配置格式**: pyproject.toml

### 文件结构
```
fish/
├── pyproject.toml          # 项目配置和依赖定义
├── uv.lock                 # 依赖版本锁定文件
├── src/
│   └── fish/
│       ├── __init__.py     # 包初始化文件
│       ├── main.py         # 应用程序入口点
│       ├── floating_window.py  # 浮动窗口 UI 实现
│       └── book_manager.py     # 书籍管理和进度保存
```

## 构建和运行

### 环境要求
- Python 3.13 或更高版本

### 安装和启动
1. 使用 uv 包管理器安装项目依赖：
   ```bash
   uv sync
   ```

2. 运行应用程序：
   ```bash
   uv run fish
   ```
   
   或者直接运行：
   ```bash
   python -m src.fish
   ```

### 开发命令
- **运行应用**: `uv run fish`
- **检查依赖**: `uv lock --check` (确保 uv.lock 与 pyproject.toml 同步)

## 使用说明

### 启动应用
1. 启动应用后会首先检查是否已有打开的书籍
2. 如果没有，则会弹出文件选择对话框供用户选择文本文件 (.txt)
3. 选择文件后，应用会显示一个固定大小的浮动窗口，展示当前行的文本内容

### 控制说明
- **上一行**: 按 Up 方向键或 W 键
- **下一行**: 按 Down 方向键或 S 键
- **退出应用**: 按 Q 键

### UI 特性
- 窗口始终置顶，便于阅读
- 无边框设计，界面简洁
- 获得焦点时边框颜色变蓝色，失去焦点时变绿色
- 半透明背景，减少视觉干扰

## 开发说明

### 核心组件

#### main.py
- 应用程序主入口
- 初始化 QApplication 和 BookManager
- 处理首次启动时的文件选择逻辑
- 创建 FloatingWindow 实例

#### floating_window.py
- 实现浮动窗口的 UI 和交互逻辑
- 处理键盘事件和鼠标点击事件
- 更新和显示文本内容
- 管理窗口的焦点状态

#### book_manager.py
- 管理用户的书籍和阅读进度
- 提供加载和保存书架数据的方法
- 实现行数统计和内容分页功能
- 提供进度更新和查询接口

### 数据存储
应用数据存储在用户的 AppData 目录中 (`%APPDATA%/fish/bookshelf.json`)，包含:
- 已打开的书籍路径
- 每本书的阅读进度
- 每本书的总行数

### 代码风格
- 遵循 Python PEP 8 代码风格规范
- 使用类型提示提高代码可读性
- 中英文注释混合，以中文为主

## 扩展功能建议

1. 支持更多文件格式（如 EPUB、PDF）
2. 添加字体大小和颜色自定义选项
3. 添加阅读统计信息（阅读时间、页数等）
4. 实现多标签页功能，同时阅读多本书籍
5. 添加书签功能，标记重要阅读位置